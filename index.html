---
layout: default
title: Gov Daisy
---
<main class="container">
    <div class="controls">
        <div class="control-group">
            <label for="year-dropdown">Fiscal Year:</label>
            <select id="year-dropdown"></select>
        </div>
        <div class="control-group">
            <label for="data-type-switch">Show:</label>
            <select id="data-type-switch">
                <option value="budget">Budget</option>
                <option value="revenue">Revenue</option>
            </select>
        </div>
    </div>
    <div id="visualisation-container">
        <div class="visualization-wrapper">
            <svg id="sunburst"></svg>
        </div>
        <div id="tooltip" class="tooltip"></div>
        <div id="legend" class="legend"></div>
    </div>
</main>
{% assign budget_years = '' | split: ',' %}
{% assign revenue_years = '' | split: ',' %}
{% for pair in site.data.budget %}
    {% assign k = pair[0] %}
    {% if k contains 'year_' %}
        {% assign budget_years = budget_years | push: k %}
    {% endif %}
{% endfor %}
{% for pair in site.data.revenue %}
    {% assign k = pair[0] %}
    {% if k contains 'year_' %}
        {% assign revenue_years = revenue_years | push: k %}
    {% endif %}
{% endfor %}
{% capture jsdata_budget %}{% assign comma = '' %}{% for y in budget_years %}{{ comma }}"{{ y | remove: 'year_' }}": {{ site.data.budget[y] | jsonify }}{% assign comma = ',' %}{% endfor %}{% endcapture %}
{% capture jsdata_revenue %}{% assign comma = '' %}{% for y in revenue_years %}{{ comma }}"{{ y | remove: 'year_' }}": {{ site.data.revenue[y] | jsonify }}{% assign comma = ',' %}{% endfor %}{% endcapture %}
<script>
    // Embed Jekyll data as JavaScript objects (all per-year files in _data/budget/ and _data/revenue/)
    window.budgetData = { {{ jsdata_budget }} };
    window.revenueData = { {{ jsdata_revenue }} };

    // Default to budget
    window.expenditureData = window.budgetData;
    window.yearSliderYears = Object.keys(window.expenditureData).sort();
</script>
<script src="{{ '/assets/js/visualisation.js' | relative_url }}"></script>
